stages:
  - build  # <--- ZUERST BAUEN
  - test   # <--- DANACH TESTEN (LINTEN)

# Vorlage f端r alle Jobs: Caching und Installation
.setup-template: &setup
  image: node:18-alpine
  cache:
    key:
      files:
        - teilzeit-ausbildungsrechner/package-lock.json
    paths:
      - teilzeit-ausbildungsrechner/node_modules/
  before_script:
    - cd teilzeit-ausbildungsrechner
    - npm install

# 1. Job: BUILD (aus der 'build'-Stage)
# Wird jetzt als Erstes ausgef端hrt.
build-job:
  <<: *setup
  stage: build
  script:
    - echo "Building project with Vite..."
    - npm run build # <--- F端hrt 'vite build' aus
  artifacts:
    # Speichert den 'dist'-Ordner (Vites Ausgabe) als Artefakt
    paths:
      - teilzeit-ausbildungsrechner/dist/

# 2. Job: LINTER (aus der 'test'-Stage)
# Wird jetzt als Zweites ausgef端hrt, nach dem Build.
lint-job:
  <<: *setup
  stage: test
  script:
    - echo "Running all linters..."
    - npm run lint # <--- Ruft 'npm run lint:html && ...' usw. auf